@using WebTruyenTranhDataAccess.Models
@model WebTruyenTranhDataAccess.Models.Episode
@{
    ViewData["Title"] = "Episode";
    Layout = "~/Views/Shared/_Layoutpage.cshtml";
    var novel = (WebTruyenTranhDataAccess.Models.Novel)ViewBag.novel;

}

    <!-- Sidebar  -->
<nav id="sidebar">
    <div id="dismiss">
        <i class="icon-times"></i>
    </div>
    <div class="sidebar-header">
        <!---book cover-->
        <img src="@novel.BookCover" class="book-cover" alt="book cover" />
        <!----thumb image-->
        <div class="row">
            <div class="col-sm">
                <img src="@novel.Thumbnail" class="thumb-image" alt="thumbnail" />
            </div>
            <div class="col-sm" style="top:20px;">
                <strong class="number-views">@Model.Views</strong>
                <span class="number-label">Views <i class="icon-eye" style="color: #e91e63c7;cursor: pointer;background: #e91e6300;"></i></span>
            </div>
            <div class="col-sm" style="top:20px;">
                <strong class="number-subcribers">@novel.LikeCount</strong>
                <span class="number-label">
                    Likes
                    <button type="submit" style="border: none; cursor: pointer;background: #e91e6300;">
                        <i class="icon-heart" style="color: #e91e63c7;"></i>
                    </button>
                </span>
            </div>
        </div>
        <div class=""><h3 class="name mb-4">@novel.Title</h3></div>
    </div>
    <!--------DESCRIPTION-SUBCRIBERS------->
    <div class="bio">
            @novel.Description
    </div>
    <a href="#" style="margin: 0 93px 0; padding: 7px 60px;" class="btn btn-primary subcribers">Subscribers</a>
    <!--------DESCRIPTION - SUBCRIBERS------->
    <!--------GENRES------->
    <div class="sidebar-box ftco-animate">
        <h3>#Genres</h3>
        <div class="tagcloud">
            @foreach (var item in novel.Genres)
            {
                <a href="#" class="tag-cloud-link">@item.GenreName</a>
            }
        </div>
    </div>

    <!---episode-list-->
    <div class="activity">
        <div class="counter d-flex">
            <div class="col">
                <strong class="number-episodes">@ViewBag.epcount</strong> Episodes
            </div>
            <div class="col">
                <a href="#"><i class="icon-sort-amount-asc"></i></a><!--------sort------->
            </div>
        </div>
        <!---episode number-list-->
        <div class="side-inner episode-list">
            <ul class="list-unstyled">
                @*<li class="episode-list-number">
                        <a href="#" class="episode-number">
                            <img class="mr-3" style=" height:17%; width: 17%; float: left;" src="@novel.Thumbnail" alt="thumb image">
                            <div class="media-body">
                                <h5 class="mt-0 mb-1">@novel.Title , Part @Model.EpisodeNumber</h5>
                                <p>Episode: @Model.EpisodeNumber</p>
                            </div>
                        </a>
                    </li>*@

            </ul>
        </div>
        <!------------------->
    </div>
</nav>
    <div class="col-lg-12">
        <!-- Page Content  -->
        @*<div id="content" style="background: #ff85ae21;">*@
            <nav class="navbar navbar-expand-lg navbar-light bg-light" style=" width: 15%;">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="icon-align-left"></i>
                        <span>Episode List</span>
                    </button>
                </div>
            </nav>
            <div class="title-header" >
                <p class="title-episode" style="text-align: center; margin: 30px 170px 13px;">@Model.Title, Part @Model.EpisodeNumber</p>
                <p class="date">@novel.LastestUpdate</p>
            </div>  
            <hr>
            <div class="content-viewer">
                @Html.Raw(Model.Content)
            </div>
            <hr />
        @*</div>*@
    </div>

    <script src="~/js/jquery-3.2.1.min.js"></script>
    <script>
    $(document).ready(function (){
        $.ajax({
            type: "POST",
            url: "/Episode/GetEpisodes/@novel.Id",
            dataType: "json",
            success: function (data) {
                var result = JSON.parse(data);
                console.log(Object.keys(result));
                $(result["$values"]).each(function (idx, ep) {
                    $('.list-unstyled').append(
                        '   <li class="episode-list-number">' +
                        '  <a href="' + '/novel/' + ep.Novel.Slugify + '/episode/' + ep.EpisodeNumber+'" class="episode-number">' +
                        ' <img class="mr-3" style=" height:17%; width: 17%; float: left;" src="' + ep.Novel.Thumbnail + '" alt="thumb image">' +
                        ' <div class="media-body">' +
                        ' <h5 class="mt-0 mb-1">' + ep.Title + ', Part' + ep.EpisodeNumber + '</h5>' +
                        '  <p>Episode:' + ep.EpisodeNumber + '</p>' +
                        '</div>' +
                        '</a>' +
                        ' </li>'
                    );
                });

            }
        });
            }

        );

    </script>

